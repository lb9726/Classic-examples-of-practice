http://c.biancheng.net/cpp/html/106.html

在C语言中，文件操作都是由库函数来完成的，这节介绍文件的打开和关闭。
文件的打开(fopen函数)

fopen() 函数用来打开一个文件，它的原型为：
FILE *fopen(char *filename, char *mode);
filename为文件名（包括文件路径），mode为打开方式，它们都是字符串。fopen() 会获取文件信息，包括文件名、文件状态、当前读写位置等，并将这些信息保存到一个FILE类型的结构体变量中，然后将该变量的地址返回。
FILE是在stdio.h头文件中定义的一个结构体，用来保存文件信息。
如果希望接收 fopen() 的返回值，就需要定义一个 FILE 类型的指针。例如：
FILE *fp = fopen("demo.txt", "r");
表示以“只读”方式打开当前目录下的 demo.txt 文件，并使 fp 指向该文件，这样就可以通过 fp 来操作 demo.txt 了。fp 通常被称为文件指针。又如：
FILE *fp = fopen("D:\\demo.txt","rb");
表示以二进制方式打开 D 盘下的 demo.txt 文件，允许读和写。

打开方式(mode)有多种，见下表：
打开方式	说明
r	以只读方式打开文件，只允许读取，不允许写入。该文件必须存在。
r+	以读/写方式打开文件，允许读取和写入。该文件必须存在。
rb+	以读/写方式打开一个二进制文件，允许读/写数据。
rt+	以读/写方式打开一个文本文件，允许读和写。
w	以只写方式打开文件，若文件存在则长度清为0，即该文件内容消失，若不存在则创建该文件。
w+	以读/写方式打开文件，若文件存在则文件长度清为零，即该文件内容会消失。若文件不存在则建立该文件。
a	以追加的方式打开只写文件。若文件不存在，则会建立该文件，如果文件存在，写入的数据会被加到文件尾，即文件原先的内容会被保留（EOF符保留)。
a+	以追加方式打开可读/写的文件。若文件不存在，则会建立该文件，如果文件存在，则写入的数据会被加到文件尾后，即文件原先的内容会被保留（原来的EOF符 不保留)。
wb	以只写方式打开或新建一个二进制文件，只允许写数据。
wb+	以读/写方式打开或建立一个二进制文件，允许读和写。
wt+	以读/写方式打开或建立一个文本文件，允许读写。
at+	以读/写方式打开一个文本文件，允许读或在文本末追加数据。
ab+	以读/写方式打开一个二进制文件，允许读或在文件末追加数据。
文本文件和二进制文件的区别请查看：C语言fopen()打开文本文件与二进制文件的区别
几点说明

1) 文件打开方式由r、w、a、t、b、+ 六个字符拼成，各字符的含义是：
r(read)：读
w(write)：写
a(append)：追加
t(text)：文本文件，可省略不写
b(banary)：二进制文件
+：读和写

2) 如果没有“b”字符，文件以文本方式打开。

3) 凡用“r”打开一个文件时，该文件必须已经存在。

4) 在打开一个文件时，如果出错，fopen将返回一个空指针值NULL。在程序中可以用这一信息来判别是否完成打开文件的工作，并作相应的处理。因此常用以下程序段打开文件：
if( (fp=fopen("D:\\demo.txt","rb") == NULL ){
    printf("Error on open D:\\demo.txt file!");
    getch();
    exit(1);
}
这段程序的意义是，如果返回的指针为空，表示不能打开D盘根目录下的 demo.txt 文件，并给出提示信息“error on open D:\\demo.txt file!”。第3行getch()的功能是从键盘输入一个字符，但不在屏幕上显示。在这里，该行的作用是等待，只有当用户从键盘敲任一键时，程序才继续执行，因此用户可利用这个等待时间阅读出错提示。敲键后执行exit(1)退出程序。

5) 把一个文本文件读入内存时，要将ASCII码转换成二进制码，而把文件以文本方式写入磁盘时，也要把二进制码转换成ASCII码，因此文本文件的读写要花费较多的转换时间。对二进制文件的读写不存在这种转换。

6) 标准输入文件 stdin（键盘）、标准输出文件 stdout（显示器）、标准错误文件 stderr（显示器）是由系统打开的，可直接使用。
文件关闭（fclose函数）

文件一旦使用完毕，应该用fclose()函数把文件关闭，以释放相关资源，避免数据丢失。fclose() 的原型为：
int fclose(FILE *fp);
fp 为文件指针。例如：
fclose(fp);
文件正常关闭时，fclose() 的返回值为0，如果返回非零值则表示有错误发生。
